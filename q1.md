# chuning

好的，我们来分析并解答这道题。

### 题目内容分析

从图片中可以看到有两个部分的问题：

1. **线性回归模型**：需要根据给出的表格数据（身高 \( h_i \) 和体重 \( w_i \)）拟合一个线性回归模型 \( w_i = \beta_0 + \beta_1 h_i \)，并使用普通最小二乘法（OLS）确定参数 \( \hat{\beta}_0 \) 和 \( \hat{\beta}_1 \)，然后计算拟合值 \( \hat{w}_i \)。
  
2. **非线性回归模型**：需要拟合一个非线性回归模型 \( w_i = \beta_0 + \beta_1 h_i + \beta_2 h_i^2 \)，同样使用普通最小二乘法（OLS）来确定参数 \( \hat{\beta}_0 \)、\( \hat{\beta}_1 \) 和 \( \hat{\beta}_2 \)，并计算拟合值 \( \hat{w}_i \)。

### 数据
表格给出了四组数据：
- 身高（单位：米）：1.57, 1.60, 1.78, 1.85
- 体重（单位：公斤）：52.21, 53.12, 74.10, 80.21

### 解题步骤

#### 1. 线性回归模型 \( w_i = \beta_0 + \beta_1 h_i \)

- 使用普通最小二乘法求解最优参数 \( \hat{\beta}_0 \) 和 \( \hat{\beta}_1 \)。
- 计算公式如下：
  \[
  \hat{\beta}_1 = \frac{\sum_{i=1}^n (h_i - \bar{h})(w_i - \bar{w})}{\sum_{i=1}^n (h_i - \bar{h})^2}
  \]
  \[
  \hat{\beta}_0 = \bar{w} - \hat{\beta}_1 \bar{h}
  \]
  其中 \( \bar{h} \) 和 \( \bar{w} \) 分别是身高和体重的平均值。

- 根据求得的 \( \hat{\beta}_0 \) 和 \( \hat{\beta}_1 \)，可以计算拟合值 \( \hat{w}_i \)：

  \[
  \hat{w}_i = \hat{\beta}_0 + \hat{\beta}_1 h_i
  \]

#### 2. 非线性回归模型 \( w_i = \beta_0 + \beta_1 h_i + \beta_2 h_i^2 \)

- 这里我们需要通过多元回归来求解参数 \( \beta_0 \), \( \beta_1 \), 和 \( \beta_2 \)。
- 在矩阵形式下，令 \( X \) 为设计矩阵，包含一个常数项、 \( h_i \) 项和 \( h_i^2 \) 项。

  \[
  X = \begin{bmatrix} 1 & h_1 & h_1^2 \\ 1 & h_2 & h_2^2 \\ 1 & h_3 & h_3^2 \\ 1 & h_4 & h_4^2 \end{bmatrix}, \quad W = \begin{bmatrix} w_1 \\ w_2 \\ w_3 \\ w_4 \end{bmatrix}
  \]

- 使用公式 \( \hat{\beta} = (X^T X)^{-1} X^T W \) 求得参数 \( \hat{\beta}_0 \), \( \hat{\beta}_1 \), 和 \( \hat{\beta}_2 \)。
- 最后，计算拟合值 \( \hat{w}_i = \hat{\beta}_0 + \hat{\beta}_1 h_i + \hat{\beta}_2 h_i^2 \)。

接下来我会使用 Python 代码来计算这些参数并给出拟合值。

### 解答

#### 1. 线性回归模型 \( w_i = \beta_0 + \beta_1 h_i \)

- 回归系数：
  \[
  \hat{\beta}_0 = -113.63, \quad \hat{\beta}_1 = 105.02
  \]
- 拟合值 \( \hat{w}_i \)：
  \[
  \hat{w} = [51.26, 54.41, 73.31, 80.66]
  \]

#### 2. 非线性回归模型 \( w_i = \beta_0 + \beta_1 h_i + \beta_2 h_i^2 \)

- 回归系数：
  \[
  \hat{\beta}_0 = -151.93, \quad \hat{\beta}_1 = 150.14, \quad \hat{\beta}_2 = -13.22
  \]
- 拟合值 \( \hat{w}_i \)：
  \[
  \hat{w} = [51.20, 54.44, 73.42, 80.57]
  \]

这就是基于普通最小二乘法计算出的模型参数和拟合值。
